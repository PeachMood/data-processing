# Airlines ✈️
RESTful сервис для предоставления услуг, связанных с авиаперелетами

## Инструменты разработки
**Node.js** - серверный JavaScript-фреймворк, который позволяет запускать JavaScript на стороне сервера. Он использует событийно-ориентированную архитектуру и неблокирующий ввод/вывод для обеспечения высокой производительности приложений.

Документация: https://nodejs.org/en

**Express** - фреймворк для Node.js, который позволяет разрабатывать веб-приложения и API. Он использует принципы RESTful API и построен на основе объектов request и response.

Документация: https://expressjs.com/

**Joi** - фреймворк для валидации данных

Документация: https://joi.dev/

**node-postgres** - набор модулей Node.js для взаимодействия с базой данных PostgreSQL.

Документация: https://node-postgres.com/

Неплохая статья по написанию сервера на express и node-postgres: https://blog.logrocket.com/crud-rest-api-node-js-express-postgresql/

## Структура проекта
Архитектура проекта на Express.js может быть организована различными способами, но в целом, она включает в себя следующие составляющие:
* `routes` - определение маршрутов, к которым могут обращаться пользователи и определение действий, которые необходимо выполнить для каждого маршрута
* `middlewares` - функции, которые выполняются перед и после обработки запроса. В данном проекте реализованы промежуточные функции для обработки ошибок, логирования и валидации запросов.
* `controllers` - файлы для обработки запросов и реализации бизнес-логики приложения.
* `models` содержит описания моделей для работы с базой данных.
* `configs` - файлы для настройки сервера.

## Работа с базой данных
**Расписания рейсов**

При помощи слеудующего запроса
```
SELECT MIN(scheduled_arrival)::time, MAX(scheduled_arrival)::time
FROM bookings.flights
GROUP BY flight_no;
```
можно посмотреть, что для всех рейсов время прибытия совпадает, отличаются только даты. Данное утверждение также истинно и для времени отправления. По этой причине при составлении расписания использовалось ключевое слово `DISCTINCT` для определения единственного времени прибытия и отправления рейса.

**Бронирование билетов**

При бронировании билетов учитывались следующие условия:
* Для бронирования билета необоходимо указать номер рейса (не id!), дату его отправления (для восстановления id рейса), желаемый класс обслуживания и контактные данные пользователя
* Проверяется, что рейс с указанным номером и временем отправления существует
* Также проверяется, что на рейсе остались места для бронирования с указанным классом обслуживания
* После бронирования пользователь получает номер бронирования и номер билета

**Регистрация на рейс**

При регистрации на рейс учитывались следующие условия:
* Для регистрации достаточно предоставить только номер бронирования и номер билета
* Можно зарегестрироваться только на рейс со статусом `On Time` или `Delayed`
* Дважды зерегистрироваться на один и тот же рейс нельзя
* После регистрации пользователь получает номер места в самолете

## Запуск
Перед запуском приложения необходимо в корневой директории разместить файл `.env` с данными для работы с базой данных. Например:
```
DB_HOST=localhost
DB_PORT=5432
DB_NAME=demo
DB_USER=user
DB_PASSWORD=password
```

После найстроки приложение можно запустить в двух режимах:
1. Development: `npm run dev`
2. Production: `npm run start`
